/*
  Communication port série
    - Allumage d'une led RGB. Celle-ci prend la couleur sélectionnée sur l'interface C#
*/

using System.IO.Ports;

namespace ArduinoCommunication
{
    public partial class Form1 : Form
    {
        public Form1()
        {
            InitializeComponent();
        }

        private void button1_Click(object sender, EventArgs e)
        {
            SerialPort port = new SerialPort("COM4", 9600, Parity.None, 8, StopBits.One);
            port.Open();
            port.Write("proc");
            port.Close();
        }

        private void button2_Click(object sender, EventArgs e)
        {
            SerialPort port = new SerialPort("COM4", 9600, Parity.None, 8, StopBits.One);
            port.Open();
            port.Write("vert");
            port.Close();
        }

        private void button4_Click(object sender, EventArgs e)
        {
            SerialPort port = new SerialPort("COM4", 9600, Parity.None, 8, StopBits.One);
            port.Open();
            port.Write("bleu");
            port.Close();
        }

        private void button5_Click(object sender, EventArgs e)
        {
            colorDialog1.ShowDialog();
            Color clr = colorDialog1.Color;
            // MessageBox.Show(clr.R + " " + clr.G + " " + clr.B);
            SerialPort port = new SerialPort("COM4", 9600, Parity.None, 8, StopBits.One);
            port.Open();
            port.Write(clr.R+"/"+clr.G+"/"+clr.B);
            // port.Write("255/123/225");
            port.Close();
        }
    }
}
